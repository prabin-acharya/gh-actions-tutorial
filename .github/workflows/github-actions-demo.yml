name: GitHub Actions Demo

run-name: ${{ github.actor }} is testing out GitHub Actions ðŸš€

on:
  issues:
    types: [opened]

permissions: 
  contents: read
  issues: write
  pull-requests: write

jobs:
  comment:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: List all open issues
        id: list-issues
        run : |
          token=$GITHUB_TOKEN
          owner=$GITHUB_REPOSITORY_OWNER
          repo=$GITHUB_REPOSITORY
          issues=$(curl -s -H "Authorization: token $token" \
                     "https://api.github.com/repos/$repo/issues?state=open" | \
                     jq -r '.[] | .number')
          echo "::set-output name=issue-list::$issues"


      - name: Comment on issue
        uses: actions/github-script@v6

        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: 'Thanks for opening this issue!.This issue was opened by ${{ github.actor }}.This is a demo of GitHub Actions.'
            })
